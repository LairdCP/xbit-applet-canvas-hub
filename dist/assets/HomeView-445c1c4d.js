import{_ as h,d as u,o,c as n,a,b as i,F as r,r as S,n as d,u as m,x as c,e as l,t as v}from"./index-ab81df0e.js";const p=u({name:"HomeView",setup(){return{devicesStore:m()}},async beforeRouteLeave(){return await this.devicesStore.stopScanning()===null},async mounted(){this.devicesStore.clear(),await this.devicesStore.disconnectDevice(),await this.devicesStore.startScanning()},methods:{formatAddress(e){const s=e.match(/.{1,2}/g);return s.reverse(),s.pop(),s.join("")},async selectDevice(e){this.devicesStore.selectDevice(e)},async connectDevice(e){c.sendToast({message:"Connecting...",options:{autoClose:!1}}),this.devicesStore.connected&&await this.devicesStore.disconnectDevice(),this.devicesStore.scanningTimeout&&await this.devicesStore.stopScanning(),this.$watch("devicesStore.connected",async s=>{s&&(c.sendClearToast(),this.$router.push({name:"update"}))});try{await this.devicesStore.connectDevice(e)}catch(s){console.log(s),c.sendToast({type:"error",message:"Unable to connect"})}}}}),g={class:"grow max-w-sm"},f={key:0,class:"p-2 m-4 text-white"},w=a("i",{class:"fa-solid fa-arrows-rotate"},null,-1),y={key:1,class:"p-2 m-4 text-white"},D=["onClick"],b={key:0},C={key:1,class:"fas fa-check"},k={class:"action-button btn-gradient-1"},_=["disabled"];function $(e,s,T,B,V,L){return o(),n(r,null,[a("div",g,[e.devicesStore.sortedDevices.length===0&&!e.devicesStore.scanningTimeout?(o(),n("h3",f,[i("Scan for BLE Devices "),w])):(o(),n("h3",y,"Select Device")),(o(!0),n(r,null,S(e.devicesStore.sortedDevices,t=>(o(),n("div",{key:t.address,class:d(["bg-canvas-slate-500 p-2 m-4 rounded text-white text-center cursor-pointer hover:bg-canvas-slate-600",{"bg-canvas-sky-500":t.address===e.devicesStore.connected,"bg-canvas-slate-600":t.address===e.devicesStore.selected,"opacity-25":!t.isCanvas}]),onClick:N=>e.selectDevice(t)},[t.isCanvas?(o(),n("span",b,"Canvas ")):l("",!0),i("Device "+v(e.formatAddress(t.address))+", "+v(t.rssi)+" dBm ",1),t.address===e.devicesStore.selected?(o(),n("i",C)):l("",!0)],10,D))),128))]),a("div",k,[a("button",{onClick:s[0]||(s[0]=t=>e.connectDevice(e.devicesStore.selected)),class:d(["bg-canvas-slate-800 p-4 w-full h-full",{"text-white cursor-pointer":e.devicesStore.selected,"text-gray-600 cursor-not-allowed":!e.devicesStore.selected}]),disabled:!e.devicesStore.selected}," Continue ",10,_)])],64)}const E=h(p,[["render",$]]);export{E as default};
